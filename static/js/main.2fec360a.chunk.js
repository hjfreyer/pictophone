(this["webpackJsonppictophone-fe"]=this["webpackJsonppictophone-fe"]||[]).push([[0],{41:function(e,t,r){e.exports=r(89)},46:function(e,t,r){},48:function(e,t,r){},89:function(e,t,r){"use strict";r.r(t);var i=r(0),n=r.n(i),a=r(38),p=r.n(a),s=(r(46),r(11)),o=r.n(s),d=r(21),u=r(7),y=(r(48),r(12)),l=r.n(y),m=(r(49),r(10)),c=r(6),g=r(14),f=r(39),b=new(r.n(f).a)({allErrors:!0,coerceTypes:!1,format:"fast",nullable:!0,unicode:!0,uniqueItems:!0,useDefaults:!0});b.addMetaSchema(r(87));b.addSchema({$schema:"http://json-schema.org/draft-07/schema#",definitions:{Action:{else:{else:{else:{properties:{kind:{enum:["join_game","start_game","make_move"],type:"string"}},required:["kind"]},if:{properties:{kind:{enum:["make_move"],type:"string"}},required:["kind"]},then:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["make_move"],type:"string"},playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["gameId","kind","playerId","submission"],type:"object"}},if:{properties:{kind:{enum:["start_game"],type:"string"}},required:["kind"]},then:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["start_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"}},if:{properties:{kind:{enum:["join_game"],type:"string"}},required:["kind"]},then:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["join_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"}},Drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},FinishedGame:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},series:{items:{defaultProperties:[],properties:{entries:{items:{defaultProperties:[],properties:{playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["playerId","submission"],type:"object"},type:"array"}},required:["entries"],type:"object"},type:"array"},state:{enum:["GAME_OVER"],type:"string"}},required:["playerIds","series","state"],type:"object"},FirstPromptGame:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["FIRST_PROMPT"],type:"string"}},required:["playerIds","state"],type:"object"},GameLog:{defaultProperties:[],properties:{entries:{items:{defaultProperties:[],properties:{action:{anyOf:[{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["join_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["start_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["make_move"],type:"string"},playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["gameId","kind","playerId","submission"],type:"object"}]},timestamp:{}},required:["action","timestamp"],type:"object"},type:"array"},lastTimestamp:{}},required:["entries","lastTimestamp"],type:"object"},GameLogEntry:{defaultProperties:[],properties:{action:{anyOf:[{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["join_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["start_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["make_move"],type:"string"},playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["gameId","kind","playerId","submission"],type:"object"}]},timestamp:{}},required:["action","timestamp"],type:"object"},JoinGame:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["join_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},MakeMove:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["make_move"],type:"string"},playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["gameId","kind","playerId","submission"],type:"object"},Path:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},PlayerGame:{else:{else:{else:{else:{else:{properties:{state:{enum:["UNSTARTED","FIRST_PROMPT","WAITING_FOR_PROMPT","RESPOND_TO_PROMPT","GAME_OVER"],type:"string"}},required:["state"]},if:{properties:{state:{enum:["GAME_OVER"],type:"string"}},required:["state"]},then:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},series:{items:{defaultProperties:[],properties:{entries:{items:{defaultProperties:[],properties:{playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["playerId","submission"],type:"object"},type:"array"}},required:["entries"],type:"object"},type:"array"},state:{enum:["GAME_OVER"],type:"string"}},required:["playerIds","series","state"],type:"object"}},if:{properties:{state:{enum:["RESPOND_TO_PROMPT"],type:"string"}},required:["state"]},then:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},prompt:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]},state:{enum:["RESPOND_TO_PROMPT"],type:"string"}},required:["playerIds","prompt","state"],type:"object"}},if:{properties:{state:{enum:["WAITING_FOR_PROMPT"],type:"string"}},required:["state"]},then:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["WAITING_FOR_PROMPT"],type:"string"}},required:["playerIds","state"],type:"object"}},if:{properties:{state:{enum:["FIRST_PROMPT"],type:"string"}},required:["state"]},then:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["FIRST_PROMPT"],type:"string"}},required:["playerIds","state"],type:"object"}},if:{properties:{state:{enum:["UNSTARTED"],type:"string"}},required:["state"]},then:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["UNSTARTED"],type:"string"}},required:["playerIds","state"],type:"object"}},Point:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},RespondToPromptGame:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},prompt:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]},state:{enum:["RESPOND_TO_PROMPT"],type:"string"}},required:["playerIds","prompt","state"],type:"object"},Series:{defaultProperties:[],properties:{entries:{items:{defaultProperties:[],properties:{playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["playerId","submission"],type:"object"},type:"array"}},required:["entries"],type:"object"},SeriesEntry:{defaultProperties:[],properties:{playerId:{type:"string"},submission:{anyOf:[{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"},{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}]}},required:["playerId","submission"],type:"object"},StartGame:{defaultProperties:[],properties:{gameId:{type:"string"},kind:{enum:["start_game"],type:"string"},playerId:{type:"string"}},required:["gameId","kind","playerId"],type:"object"},Submission:{else:{else:{properties:{kind:{enum:["word","drawing"],type:"string"}},required:["kind"]},if:{properties:{kind:{enum:["drawing"],type:"string"}},required:["kind"]},then:{defaultProperties:[],properties:{drawing:{defaultProperties:[],properties:{paths:{items:{defaultProperties:[],properties:{points:{items:{defaultProperties:[],properties:{x:{type:"number"},y:{type:"number"}},required:["x","y"],type:"object"},type:"array"}},required:["points"],type:"object"},type:"array"}},required:["paths"],type:"object"},kind:{enum:["drawing"],type:"string"}},required:["drawing","kind"],type:"object"}},if:{properties:{kind:{enum:["word"],type:"string"}},required:["kind"]},then:{defaultProperties:[],properties:{kind:{enum:["word"],type:"string"},word:{type:"string"}},required:["kind","word"],type:"object"}},UnstartedGame:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["UNSTARTED"],type:"string"}},required:["playerIds","state"],type:"object"},WaitingForPromptGame:{defaultProperties:[],properties:{playerIds:{items:{type:"string"},type:"array"},state:{enum:["WAITING_FOR_PROMPT"],type:"string"}},required:["playerIds","state"],type:"object"}}},"Schema");var P=r(22);function h(e){if(0==e.points.length)return"";if(1==e.points.length){var t=e.points[0],r=t.x,i=t.y;return"M ".concat(r," ").concat(i," L ").concat(r+1," ").concat(i)}var n="M ".concat(e.points[0].x," ").concat(e.points[0].y),a=!0,p=!1,s=void 0;try{for(var o,d=e.points.slice(1)[Symbol.iterator]();!(a=(o=d.next()).done);a=!0){var u=o.value,y=u.x,l=u.y;n+="L ".concat(y," ").concat(l)}}catch(m){p=!0,s=m}finally{try{a||null==d.return||d.return()}finally{if(p)throw s}}return n}var j=function(e){var t=e.drawing,r=e.width,a=e.height,p=Object(i.useRef)(null);return Object(i.useEffect)((function(){var e=p.current;e.style.width=r+"px",e.style.height=a+"px"})),n.a.createElement("svg",{ref:p,style:{touchAction:"none"}},t.paths.map((function(e,t){return n.a.createElement("path",{key:t,d:h(e),stroke:"black",fill:"transparent"})})))};var w=function(e){var t=e.draft,r=e.onChange;return n.a.createElement("div",{onTouchStart:function(e){e.preventDefault(),console.log("touchstart"),r(Object(P.a)(t,(function(t){for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches.item(r);t.inProgress[i.identifier]=t.drawing.paths.length;var n=e.target.getBoundingClientRect(),a={x:i.clientX-n.left,y:i.clientY-n.top};t.drawing.paths.push({points:[a]})}})))},onTouchMove:function(e){e.preventDefault(),console.log("touchmove"),r(Object(P.a)(t,(function(t){for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches.item(r),n=e.target.getBoundingClientRect(),a={x:i.clientX-n.left,y:i.clientY-n.top};t.drawing.paths[t.inProgress[i.identifier]].points.push(a)}})))},style:{touchAction:"none"}},n.a.createElement(j,{drawing:t.drawing,width:500,height:500}))},I=function(e){var t=e.playerGame,r=e.submit,a=Object(i.useState)(""),p=Object(u.a)(a,2),s=p[0],o=p[1],d=Object(i.useState)({drawing:{paths:[]},inProgress:{}}),y=Object(u.a)(d,2),l=y[0],m=y[1],c=function(e){e.preventDefault(),r({kind:"word",word:s}),o("")},g=n.a.createElement("div",null,"Players: ",t.playerIds.map((function(e,t){return n.a.createElement("div",{key:t},e)})));switch(t.state){case"FIRST_PROMPT":return n.a.createElement("main",{id:"game"},n.a.createElement("header",null,"Pictophone!"),n.a.createElement("div",{className:"instructions"},"Come up with a thing!"),n.a.createElement("form",{onSubmit:c},n.a.createElement("input",{value:s,onChange:function(e){return o(e.target.value)}}),n.a.createElement("button",null,"Submit")));case"WAITING_FOR_PROMPT":return n.a.createElement("div",null,g,"Chill out for a sec while everyone else finishes.");case"RESPOND_TO_PROMPT":return"word"===t.prompt.kind?n.a.createElement("div",null,g,n.a.createElement("div",null,"Your prompt is: ",t.prompt.word),n.a.createElement("div",null,"Drawz!"),n.a.createElement(w,{draft:l,onChange:m}),n.a.createElement("button",{onClick:function(){r({kind:"drawing",drawing:l.drawing})}},"Submit")):n.a.createElement("div",null,g,n.a.createElement("div",null,"Your prompt is:"),n.a.createElement(j,{drawing:t.prompt.drawing,width:500,height:500}),n.a.createElement("div",null,"Describe!"),n.a.createElement("form",{onSubmit:c},n.a.createElement("input",{value:s,onChange:function(e){return o(e.target.value)}}),n.a.createElement("button",null,"Submit")))}},k=function(e){var t=e.series,r=e.seriesIdx;return n.a.createElement("div",null,n.a.createElement("h2",null,"Series ",r),t.entries.map((function(e,t){return n.a.createElement(q,{key:t,entry:e})})))},q=function(e){var t=e.entry;return"word"===t.submission.kind?n.a.createElement("div",null,n.a.createElement("h3",null,t.playerId," said"),n.a.createElement("div",null,t.submission.word)):n.a.createElement("div",null,n.a.createElement("h3",null,t.playerId," drew"),n.a.createElement(j,{drawing:t.submission.drawing,width:500,height:500}))},E=function(e){var t=e.playerGame,r=e.startGame,i=e.submit,a=n.a.createElement("div",null,"Players: ",t.playerIds.map((function(e,t){return n.a.createElement("div",{key:t},e)})));switch(t.state){case"UNSTARTED":return n.a.createElement("div",null,a,"Waiting to start game.",n.a.createElement("button",{onClick:r},"Start Game"));case"FIRST_PROMPT":case"WAITING_FOR_PROMPT":case"RESPOND_TO_PROMPT":return n.a.createElement(I,{playerGame:t,submit:i});case"GAME_OVER":return n.a.createElement("div",null,a,t.series.map((function(e,t){return n.a.createElement(k,{key:t,series:e,seriesIdx:t})})))}},v=function(e){var t=e.join,r=Object(i.useState)(""),a=Object(u.a)(r,2),p=a[0],s=a[1];return n.a.createElement("div",null,n.a.createElement("h2",null,"Join A Game"),n.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(p)}},n.a.createElement("input",{type:"text",value:p,onChange:function(e){return s(e.target.value)}}),n.a.createElement("button",null,"Submit")))},O=function(e){var t=e.playerId,r=e.dispatch;return n.a.createElement("div",null,n.a.createElement("h1",null,"User page for ",t),n.a.createElement(v,{join:function(e){return r({kind:"join_game",playerId:t,gameId:e})}}),n.a.createElement("h2",null,"Existing Games"),n.a.createElement(m.a,{path:"versions/0/players/".concat(t,"/games"),render:function(e){var r=e.isLoading,i=e.data;return n.a.createElement("div",null,r?n.a.createElement("span",null,"Loading..."):n.a.createElement("div",null,i.map((function(e){return n.a.createElement("div",{key:e.id},n.a.createElement(g.b,{to:"/g/".concat(e.id,"?u=").concat(t)},e.id))}))))}}))};l.a.initializeApp({projectId:"pictophone-app"}).firestore();var T=function(){var e=Object(i.useState)(""),t=Object(u.a)(e,2),r=t[0],a=t[1],p=Object(c.f)();return n.a.createElement("div",null,n.a.createElement("h1",null,"Sign In"),n.a.createElement("form",{onSubmit:function(){return p.push("?u="+r)}},n.a.createElement("input",{type:"text",value:r,onChange:function(e){return a(e.target.value)}}),n.a.createElement("button",null,"Submit")))},_=function(e){var t=e.playerId,r=e.dispatch,i=Object(c.h)().gameId,a=function(){return r({kind:"start_game",playerId:t,gameId:i})},p=function(e){return r({kind:"make_move",playerId:t,gameId:i,submission:e})};return n.a.createElement(m.b,{path:"versions/0/players/".concat(t,"/games/").concat(i),render:function(e){var t=e.isLoading,r=e.data;if(t)return n.a.createElement("span",null,"Loading...");var i=function(e){var t=b.getSchema("Schema#/definitions/".concat(e));return function(r){if(!t)throw new Error("No validator defined for Schema#/definitions/".concat(e));if(!t(r))throw new Error("Invalid "+e+": "+b.errorsText(t.errors.filter((function(e){return"if"!==e.keyword})),{dataVar:e}));return r}}("PlayerGame")(r);return n.a.createElement(E,{playerGame:i,startGame:a,submit:p})}})};function R(e){return x.apply(this,arguments)}function x(){return(x=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.pictophone.app/action",{method:"post",body:JSON.stringify(t),mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"}});case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=function(){var e=new URLSearchParams(Object(c.g)().search).get("u");if(null===e)return n.a.createElement(T,null);var t=function(){var e=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n.a.createElement(c.c,null,n.a.createElement(c.a,{path:"/",exact:!0},n.a.createElement(O,{playerId:e,dispatch:t})),n.a.createElement(c.a,{path:"/g/:gameId",exact:!0},n.a.createElement(_,{playerId:e,dispatch:t})))},G=function(){return n.a.createElement(m.c,{firebase:l.a},n.a.createElement(g.a,null,n.a.createElement(S,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));p.a.render(n.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[41,1,2]]]);
//# sourceMappingURL=main.2fec360a.chunk.js.map